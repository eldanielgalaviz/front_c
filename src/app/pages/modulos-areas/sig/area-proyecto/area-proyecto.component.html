<form [formGroup]="recoInfo" (ngSubmit)="addNewProjectArea()">
    <div>
    <p-fieldset legend="PHINA">
        <div class="formgrid grid">
            <div class="field col-12 md:col-4">
                <span class="p-float-label">
                    <p-dropdown styleClass="p-inputtext-lg" [options]="catalogcertificacion"
                    formControlName="Idcertificacion" id="Idcertificacion" placeholder="select a certification" 
                    optionLabel="Certificacion" optionValue="Idcertificacion" [showClear]="true"></p-dropdown>
                    <label for="Idcertificacion">Certification</label>
                </span>
                <small *ngIf="isFieldInvalidAndTouched('Idcertificacion')" id="blErrorIdcertificacion" class="p-error">Certification is required.</small>
            </div>
            <div class="field col-12 md:col-4">
                <span class="p-float-label">
                    <input class="p-inputtext" formControlName="SuperficieTotalPhina" id="SuperficieTotalPhina" step=".01" required type="number" pInputText>
                    <label for="SuperficieTotalPhina">Total area (ha)</label>
                </span>
            </div>
            <div class="field col-12 md:col-4">
                <span class="p-float-label">
                    <input class="p-inputtext" formControlName="Achurado" id="Achurado" type="number" step=".01" pInputText>
                    <label for="Achurado">Achurado (ha)</label>
                </span>
            </div>
            <div class="field col-12 md:col-6">
                <span class="p-float-label">
                    <input class="p-inputtext" formControlName="Expopriado" id="Expopriado" type="number" step=".01" pInputText>
                    <label for="Expopriado">Expropriated (ha)</label>
                </span>
            </div>
            <div class="field col-12 md:col-6">
                <span class="p-float-label">
                    <input class="p-inputtext" formControlName="LinkPHINA" id="LinkPHINA" pInputText>
                    <label for="LinkPHINA">Link PHINA</label>
                </span>
                <small class="p-error" severity="error" *ngIf="!recoInfo.get('LinkPHINA')?.valid && recoInfo.get('LinkPHINA')?.touched || null">
                    Please enter a valid URL.
                  </small>
            </div>
        </div>
    </p-fieldset>
    <p-fieldset legend="RAN PERIMETRALES">
        <div class="formgrid grid">
            <div class="field col-12 md:col-4">
                <span class="p-float-label">
                    <input class="p-inputtext" formControlName="SuperficieTotal" id="SuperficieTotal" step=".01" type="number" pInputText>
                    <label for="SuperficieTotal">Total perimeter area of the RAN (ha)</label>
                </span>
            </div>
        </div>
    </p-fieldset>
    <p-fieldset legend="PLANO INTERNO">
        <div class="formgrid grid">
            <div class="field col-12 md:col-4">
                <span class="p-float-label">
                        <p-dropdown styleClass="p-inputtext-lg" [options]="catalogRequestalRan"
                            formControlName="IdsolicitudRAN" placeholder="select a SolictiudalRAM"
                            optionLabel="SolictiudalRAM" optionValue="IdsolicitudRAN" [showClear]="true"></p-dropdown>
                        <label for="IdsolicitudRAN">RAN Application</label>
                </span>
                <small *ngIf="isFieldInvalidAndTouched('IdsolicitudRAN')" id="blErrorIdsolicitudRAN" class="p-error">RAN Application is required.</small>
            </div>
            <div class="field col-12 md:col-4">
                <span class="p-float-label">
                    <input class="p-inputtext" formControlName="SuperficiePlanoInterno" id="SuperficiePlanoInterno" step=".01" type="number" pInputText>
                    <label for="SuperficiePlanoInterno">Internal flat surface</label>
                </span>
            </div>
            <div class="field col-12 md:col-4">
                <span class="p-float-label">
                    <input class="p-inputtext-lg" formControlName="AreasExpropiadas" id="AreasExpropiadas" type="number" step=".01" pInputText>
                    <label for="AreasExpropiadas">expropriated areas (ha)</label>
                </span>
            </div>
            <div class="field col-12 md:col-3">
                <span class="p-float-label">
                    <p-calendar class="p-inputtext" formControlName="AñodelPlan" view="year" dateFormat="yy" inputId="yearpicker"></p-calendar>
                    <label for="AnodelPlan">Plan year</label>
                    <small class="p-error" severity="error" *ngIf="!recoInfo.get('AñodelPlan')?.valid && recoInfo.get('AñodelPlan')?.touched || null">
                        Please enter a valid year.
                      </small>
                </span>
            </div>
            <div class="field col-12 md:col-9">
                <span class="p-float-label">
                    <input class="p-inputtext" formControlName="LinkPlanoInterno" appNoEmoji id="LinkPlanoInterno" type="text"
                        pInputText>
                    <label for="LinkPlanoInterno">Internal flat link</label>
                </span>
            </div>


        </div>
    </p-fieldset>
    <p-fieldset legend="VALIDACION">
        <div class="formgrid grid">
            <div class="field col-12 md:col-4">
                <span class="p-float-label">
                    <p-dropdown styleClass="p-inputtext-lg" [options]="catalogstatusvalidacionap"
                        formControlName="IdStatusValidacionAP"
                        optionLabel="StatusValicionAP" optionValue="IdstatusValidacionAP"></p-dropdown>
                        <small *ngIf="isFieldInvalidAndTouched('IdStatusValidacionAP')" id="blErrorIdStatusValidacionAP" class="p-error">This field is required</small>
                </span>
            </div>                            

            <div class="field col-12 md:col-8">
                <span class="p-float-label">
                    <input class="p-inputtext-lg" formControlName="LinkAP" id="LinkAP" type="text" pInputText>
                    <label for="LinkAP">Link AP</label>
                </span>
            </div>
            <div class="field col-12 md:col-12">
                <span class="p-float-label">
                    <textarea rows="5" cols="30" formControlName="ObservacionesAP" pInputTextarea></textarea>
                    <label for="ObservacionesAP">Observaciones AP</label>
                </span>
            </div>

            
        </div>
    </p-fieldset>
</div>
</form> 

<div class="flex justify-content-center">
    <p-button class="m-2" [disabled]="enablebutton" *ngIf="buttonLabel === 'Create'" [label]="buttonLabel" icon="pi pi-file-o" (click)="updateProjectArea()"></p-button>
    <p-button class="m-2" [disabled]="enablebutton" *ngIf="buttonLabel === 'Edit'" [label]="buttonLabel" icon="pi pi-file-o" (click)="updateProjectArea()"></p-button>
</div>

<div class="col-12">
    <h3 class="text-center">Historial</h3>
    <p-table [value]="projectHistory" [paginator]="true" [rows]="5" [showCurrentPageReport]="true" [tableStyle]="{ 'min-width': '50rem' }"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [rowsPerPageOptions]="[10, 25, 50]" >
    <ng-template pTemplate="header">
        <tr>
            <th style="width:25%">Total area</th>
            <th style="width:25%">Modify Date</th>
            <th style="width:25%">ID User</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-customer>
        <tr>
            <td>{{ customer.SuperficieTotalPhina }}</td>
            <td>{{ customer.FechaModificacion | date }}</td>
            <td>{{ customer.idUserModify }}</td>
        </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
        <tr>
            <td colspan="5">No historial found.</td>
        </tr>
    </ng-template>
</p-table>
</div>
 
<p-toast position="top-right"></p-toast>
<app-alerta></app-alerta>