<section class="m-1">
    <div class="grid">
        <div class="col-12 md:col-12">
            <p-table paginatorDropdownAppendTo="body" [value]="AnnualPlans" [paginator]="true" [rows]="10"  currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [rowsPerPageOptions]="[10, 25, 50]" dataKey="id" [tableStyle]="{ 'min-width': '50rem' }">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Code</th>
                        <th>RP Selected</th>
                        <th>Draft</th>
                        <th>Description</th>
                        <th>Date</th>
                        <th>Status</th>
                        <th></th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-product>
                    <tr>
                        <td>{{ product.FolioPadi }}</td>
                        <td>RP{{ product.idrpnumber }}</td>
                        <td>{{ product.name }}</td>
                        <td>{{truncateText(product.description, 40)}}</td>
                        <td>{{ product.DateCreate | date: 'dd/MM/yyyy HH:mm': 'UTC' }}</td>
                        <td>
                            <span *ngIf="product.status == 1" class="m-2 status-pending"><strong>Pending</strong></span>
                            <span *ngIf="product.status == 2" class="m-2 status-correction"><strong>Correction</strong></span>
                            <span *ngIf="product.status == 3" class="m-2 status-evaluation"><strong>Evaluation</strong></span>
                            <span *ngIf="product.status == 4" class="m-2 status-finished"><strong>Approved</strong></span>
                            <span *ngIf="product.status == 5" class="m-2 status-canceled"><strong>Canceled</strong></span>
                            <span *ngIf="product.status == 6" class="m-2 status-assembly-approved"><strong>Approved</strong></span>
                        </td>
                        <td>
                            <p-button class="m-1" (click)="redirectToPreview(product)" icon="pi pi-eye"></p-button>
                            <p-button class="m-1" (onClick)="onRowSelected(product)" icon="pi pi-pencil"></p-button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="3">There are no Annual plans</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</section>

<p-dialog header="Update Activities By Annual Plan" [(visible)]="visible" [style]="{width: '50vw'}" [maximizable]="true" (onHide)="hideDialog()">
    <div class="flex justify-content-center m-3">
        <div>
           <div class="text-2xl text-800">Annual Plan Selected: Example Plan</div>
        </div>
    </div>
    <div class="grid">
        <div class="col-12 md:col-12">
            <p-pickList [source]="ActivitiesWithoutPlan" [target]="activitiesByPlan" sourceHeader="Unassigned Activities" targetHeader="Assigned activities" [dragdrop]="true" [responsive]="true" [sourceStyle]="{ height: '30rem' }"
                [targetStyle]="{ height: '30rem' }" [filterBy]="'NombreActividad,Actividad,EstimadoUSD'" sourceFilterPlaceholder="Search by Activity Name" targetFilterPlaceholder="Search by Activity Name" breakpoint="1400px">
                <ng-template let-product pTemplate="item">
                    <div class="flex flex-wrap p-2 align-items-center gap-3">
                        <div class="flex-1 flex flex-column gap-2">
                            <span class="font-bold">{{ product.Actividad || product.NombreActividad}}</span>
                            <div class="flex align-products-center gap-2">
                                <span>{{ product.EstimadoUSD | currency }}</span>
                            </div>
                        </div>
                    </div>
                </ng-template>
            </p-pickList>
            <div class="flex justify-content-end m-5">
                <p class="text-lg font-semibold">Total: {{getTotalActivitiesSelected(activitiesByPlan) | currency: 'USD'}}</p>
            </div>
        </div>
    </div>
    <ng-template pTemplate="footer">
        <p-button label="Cancel" icon="pi pi-angle-left" (onClick)="hideDialog()"></p-button>
        <p-button class="m-1" [disabled]="activitiesByPlan.length == 0" icon="pi pi-save" (click)="saveActivitiesByAnnualPlan()" label="Save changes"></p-button>
    </ng-template>
</p-dialog>